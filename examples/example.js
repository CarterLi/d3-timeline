'use strict';

Date.prototype.toDateInputValue = function toDateInputValue() {
  var local = new Date(this);
  local.setMinutes(this.getMinutes() - this.getTimezoneOffset());
  return local.toJSON().slice(0, 23);
};

const iconTestData = [{"label":"20161021_101648_675","class":"warn","times":[{"starting_time":1480903320000,"ending_time":1480903380000,"value":58},{"starting_time":1480903380000,"ending_time":1480904700000,"value":60},{"starting_time":1480904760000,"ending_time":1480904820000,"value":7},{"starting_time":1480905900000,"ending_time":1480905960000,"value":58},{"starting_time":1480905960000,"ending_time":1480914720000,"value":60},{"starting_time":1480914780000,"ending_time":1480914840000,"value":42},{"starting_time":1480914960000,"ending_time":1480915020000,"value":11},{"starting_time":1480915020000,"ending_time":1480973040000,"value":60}]},{"label":"20161018_104523_030","class":"warn","times":[{"starting_time":1480903320000,"ending_time":1480903380000,"value":1},{"starting_time":1480903620000,"ending_time":1480903680000,"value":1},{"starting_time":1480903920000,"ending_time":1480903980000,"value":1},{"starting_time":1480904220000,"ending_time":1480904280000,"value":1},{"starting_time":1480904520000,"ending_time":1480904580000,"value":1},{"starting_time":1480905900000,"ending_time":1480905960000,"value":1},{"starting_time":1480906200000,"ending_time":1480906260000,"value":1},{"starting_time":1480906500000,"ending_time":1480906560000,"value":1},{"starting_time":1480906800000,"ending_time":1480906860000,"value":1},{"starting_time":1480907100000,"ending_time":1480907160000,"value":1},{"starting_time":1480907400000,"ending_time":1480907460000,"value":1},{"starting_time":1480907700000,"ending_time":1480907760000,"value":1},{"starting_time":1480908000000,"ending_time":1480908060000,"value":1},{"starting_time":1480908300000,"ending_time":1480908360000,"value":1},{"starting_time":1480908600000,"ending_time":1480908660000,"value":1},{"starting_time":1480908900000,"ending_time":1480908960000,"value":1},{"starting_time":1480909200000,"ending_time":1480909260000,"value":1},{"starting_time":1480909500000,"ending_time":1480909560000,"value":1},{"starting_time":1480909800000,"ending_time":1480909860000,"value":1},{"starting_time":1480910100000,"ending_time":1480910160000,"value":1},{"starting_time":1480910400000,"ending_time":1480910460000,"value":1},{"starting_time":1480910700000,"ending_time":1480910760000,"value":1},{"starting_time":1480911000000,"ending_time":1480911060000,"value":1},{"starting_time":1480911300000,"ending_time":1480911360000,"value":1},{"starting_time":1480911600000,"ending_time":1480911660000,"value":1},{"starting_time":1480911900000,"ending_time":1480911960000,"value":1},{"starting_time":1480912200000,"ending_time":1480912260000,"value":1},{"starting_time":1480912500000,"ending_time":1480912560000,"value":1},{"starting_time":1480912800000,"ending_time":1480912860000,"value":1},{"starting_time":1480913100000,"ending_time":1480913160000,"value":1},{"starting_time":1480913400000,"ending_time":1480913460000,"value":1},{"starting_time":1480913700000,"ending_time":1480913760000,"value":1},{"starting_time":1480914000000,"ending_time":1480914060000,"value":1},{"starting_time":1480914300000,"ending_time":1480914360000,"value":1},{"starting_time":1480914600000,"ending_time":1480914660000,"value":1},{"starting_time":1480914960000,"ending_time":1480915020000,"value":1},{"starting_time":1480915260000,"ending_time":1480915320000,"value":1},{"starting_time":1480915560000,"ending_time":1480915620000,"value":1},{"starting_time":1480915860000,"ending_time":1480915920000,"value":1},{"starting_time":1480916160000,"ending_time":1480916220000,"value":1},{"starting_time":1480916460000,"ending_time":1480916520000,"value":1},{"starting_time":1480916760000,"ending_time":1480916820000,"value":1},{"starting_time":1480917060000,"ending_time":1480917120000,"value":1},{"starting_time":1480917360000,"ending_time":1480917420000,"value":1},{"starting_time":1480917660000,"ending_time":1480917720000,"value":1},{"starting_time":1480917960000,"ending_time":1480918020000,"value":1},{"starting_time":1480918260000,"ending_time":1480918320000,"value":1},{"starting_time":1480918620000,"ending_time":1480918680000,"value":1},{"starting_time":1480918920000,"ending_time":1480918980000,"value":1},{"starting_time":1480919220000,"ending_time":1480919280000,"value":1},{"starting_time":1480919520000,"ending_time":1480919580000,"value":1},{"starting_time":1480919820000,"ending_time":1480919880000,"value":1},{"starting_time":1480920120000,"ending_time":1480920180000,"value":1},{"starting_time":1480920420000,"ending_time":1480920480000,"value":1},{"starting_time":1480920720000,"ending_time":1480920780000,"value":1},{"starting_time":1480921020000,"ending_time":1480921080000,"value":1},{"starting_time":1480921320000,"ending_time":1480921380000,"value":1},{"starting_time":1480921620000,"ending_time":1480921680000,"value":1},{"starting_time":1480921920000,"ending_time":1480921980000,"value":1},{"starting_time":1480922220000,"ending_time":1480922280000,"value":1},{"starting_time":1480922520000,"ending_time":1480922580000,"value":1},{"starting_time":1480922820000,"ending_time":1480922880000,"value":1},{"starting_time":1480923120000,"ending_time":1480923180000,"value":1},{"starting_time":1480923420000,"ending_time":1480923480000,"value":1},{"starting_time":1480923720000,"ending_time":1480923780000,"value":1},{"starting_time":1480924020000,"ending_time":1480924080000,"value":1},{"starting_time":1480924320000,"ending_time":1480924380000,"value":1},{"starting_time":1480924620000,"ending_time":1480924680000,"value":1},{"starting_time":1480924920000,"ending_time":1480924980000,"value":1},{"starting_time":1480925220000,"ending_time":1480925280000,"value":1},{"starting_time":1480925520000,"ending_time":1480925580000,"value":1},{"starting_time":1480925820000,"ending_time":1480925880000,"value":1},{"starting_time":1480926120000,"ending_time":1480926180000,"value":1},{"starting_time":1480926420000,"ending_time":1480926480000,"value":1},{"starting_time":1480926720000,"ending_time":1480926780000,"value":1},{"starting_time":1480927020000,"ending_time":1480927080000,"value":1},{"starting_time":1480927320000,"ending_time":1480927380000,"value":1},{"starting_time":1480927620000,"ending_time":1480927680000,"value":1},{"starting_time":1480927920000,"ending_time":1480927980000,"value":1},{"starting_time":1480928220000,"ending_time":1480928280000,"value":1},{"starting_time":1480928520000,"ending_time":1480928580000,"value":1},{"starting_time":1480928820000,"ending_time":1480928880000,"value":1},{"starting_time":1480929120000,"ending_time":1480929180000,"value":1},{"starting_time":1480929420000,"ending_time":1480929480000,"value":1},{"starting_time":1480929720000,"ending_time":1480929780000,"value":1},{"starting_time":1480930020000,"ending_time":1480930080000,"value":1},{"starting_time":1480930320000,"ending_time":1480930380000,"value":1},{"starting_time":1480930620000,"ending_time":1480930680000,"value":1},{"starting_time":1480930920000,"ending_time":1480930980000,"value":1},{"starting_time":1480931220000,"ending_time":1480931280000,"value":1},{"starting_time":1480931520000,"ending_time":1480931580000,"value":1},{"starting_time":1480931820000,"ending_time":1480931880000,"value":1},{"starting_time":1480932120000,"ending_time":1480932180000,"value":1},{"starting_time":1480932420000,"ending_time":1480932480000,"value":1},{"starting_time":1480932720000,"ending_time":1480932780000,"value":1},{"starting_time":1480933020000,"ending_time":1480933080000,"value":1},{"starting_time":1480933320000,"ending_time":1480933380000,"value":1},{"starting_time":1480933620000,"ending_time":1480933680000,"value":1},{"starting_time":1480933920000,"ending_time":1480933980000,"value":1},{"starting_time":1480934220000,"ending_time":1480934280000,"value":1},{"starting_time":1480934520000,"ending_time":1480934580000,"value":1},{"starting_time":1480934820000,"ending_time":1480934880000,"value":1},{"starting_time":1480935120000,"ending_time":1480935180000,"value":1},{"starting_time":1480935420000,"ending_time":1480935480000,"value":1},{"starting_time":1480935720000,"ending_time":1480935780000,"value":1},{"starting_time":1480936020000,"ending_time":1480936080000,"value":1},{"starting_time":1480936320000,"ending_time":1480936380000,"value":1},{"starting_time":1480936620000,"ending_time":1480936680000,"value":1},{"starting_time":1480936920000,"ending_time":1480936980000,"value":1},{"starting_time":1480937220000,"ending_time":1480937280000,"value":1},{"starting_time":1480937520000,"ending_time":1480937580000,"value":1},{"starting_time":1480937820000,"ending_time":1480937880000,"value":1},{"starting_time":1480938120000,"ending_time":1480938180000,"value":1},{"starting_time":1480938420000,"ending_time":1480938480000,"value":1},{"starting_time":1480938720000,"ending_time":1480938780000,"value":1},{"starting_time":1480939020000,"ending_time":1480939080000,"value":1},{"starting_time":1480939320000,"ending_time":1480939380000,"value":1},{"starting_time":1480939620000,"ending_time":1480939680000,"value":1},{"starting_time":1480939920000,"ending_time":1480939980000,"value":1},{"starting_time":1480940220000,"ending_time":1480940280000,"value":1},{"starting_time":1480940520000,"ending_time":1480940580000,"value":1},{"starting_time":1480940820000,"ending_time":1480940880000,"value":1},{"starting_time":1480941120000,"ending_time":1480941180000,"value":1},{"starting_time":1480941420000,"ending_time":1480941480000,"value":1},{"starting_time":1480941720000,"ending_time":1480941780000,"value":1},{"starting_time":1480942020000,"ending_time":1480942080000,"value":1},{"starting_time":1480942320000,"ending_time":1480942380000,"value":1},{"starting_time":1480942620000,"ending_time":1480942680000,"value":1},{"starting_time":1480942920000,"ending_time":1480942980000,"value":1},{"starting_time":1480943220000,"ending_time":1480943280000,"value":1},{"starting_time":1480943520000,"ending_time":1480943580000,"value":1},{"starting_time":1480943820000,"ending_time":1480943880000,"value":1},{"starting_time":1480944120000,"ending_time":1480944180000,"value":1},{"starting_time":1480944420000,"ending_time":1480944480000,"value":1},{"starting_time":1480944720000,"ending_time":1480944780000,"value":1},{"starting_time":1480945020000,"ending_time":1480945080000,"value":1},{"starting_time":1480945320000,"ending_time":1480945380000,"value":1},{"starting_time":1480945620000,"ending_time":1480945680000,"value":1},{"starting_time":1480945920000,"ending_time":1480945980000,"value":1},{"starting_time":1480946220000,"ending_time":1480946280000,"value":1},{"starting_time":1480946520000,"ending_time":1480946580000,"value":1},{"starting_time":1480946880000,"ending_time":1480946940000,"value":1},{"starting_time":1480947180000,"ending_time":1480947240000,"value":1},{"starting_time":1480947480000,"ending_time":1480947540000,"value":1},{"starting_time":1480947780000,"ending_time":1480947840000,"value":1},{"starting_time":1480948080000,"ending_time":1480948140000,"value":1},{"starting_time":1480948380000,"ending_time":1480948440000,"value":1},{"starting_time":1480948680000,"ending_time":1480948740000,"value":1},{"starting_time":1480948980000,"ending_time":1480949040000,"value":1},{"starting_time":1480949280000,"ending_time":1480949340000,"value":1},{"starting_time":1480949580000,"ending_time":1480949640000,"value":1},{"starting_time":1480949880000,"ending_time":1480949940000,"value":1},{"starting_time":1480950180000,"ending_time":1480950240000,"value":1},{"starting_time":1480950480000,"ending_time":1480950540000,"value":1},{"starting_time":1480950780000,"ending_time":1480950840000,"value":1},{"starting_time":1480951080000,"ending_time":1480951140000,"value":1},{"starting_time":1480951380000,"ending_time":1480951440000,"value":1},{"starting_time":1480951680000,"ending_time":1480951740000,"value":1},{"starting_time":1480951980000,"ending_time":1480952040000,"value":1},{"starting_time":1480952280000,"ending_time":1480952340000,"value":1},{"starting_time":1480952580000,"ending_time":1480952640000,"value":1},{"starting_time":1480952880000,"ending_time":1480952940000,"value":1},{"starting_time":1480953180000,"ending_time":1480953240000,"value":1},{"starting_time":1480953480000,"ending_time":1480953540000,"value":1},{"starting_time":1480953780000,"ending_time":1480953840000,"value":1},{"starting_time":1480954080000,"ending_time":1480954140000,"value":1},{"starting_time":1480954380000,"ending_time":1480954440000,"value":1},{"starting_time":1480954680000,"ending_time":1480954740000,"value":1},{"starting_time":1480954980000,"ending_time":1480955040000,"value":1},{"starting_time":1480955280000,"ending_time":1480955340000,"value":1},{"starting_time":1480955580000,"ending_time":1480955640000,"value":1},{"starting_time":1480955880000,"ending_time":1480955940000,"value":1},{"starting_time":1480956180000,"ending_time":1480956240000,"value":1},{"starting_time":1480956480000,"ending_time":1480956540000,"value":1},{"starting_time":1480956780000,"ending_time":1480956840000,"value":1},{"starting_time":1480957080000,"ending_time":1480957140000,"value":1},{"starting_time":1480957380000,"ending_time":1480957440000,"value":1},{"starting_time":1480957680000,"ending_time":1480957740000,"value":1},{"starting_time":1480957980000,"ending_time":1480958040000,"value":1},{"starting_time":1480958280000,"ending_time":1480958340000,"value":1},{"starting_time":1480958580000,"ending_time":1480958640000,"value":1},{"starting_time":1480958880000,"ending_time":1480958940000,"value":1},{"starting_time":1480959180000,"ending_time":1480959240000,"value":1},{"starting_time":1480959480000,"ending_time":1480959540000,"value":1},{"starting_time":1480959780000,"ending_time":1480959840000,"value":1},{"starting_time":1480960080000,"ending_time":1480960140000,"value":1},{"starting_time":1480960380000,"ending_time":1480960440000,"value":1},{"starting_time":1480960680000,"ending_time":1480960740000,"value":1},{"starting_time":1480960980000,"ending_time":1480961040000,"value":1},{"starting_time":1480961280000,"ending_time":1480961340000,"value":1},{"starting_time":1480961580000,"ending_time":1480961640000,"value":1},{"starting_time":1480961880000,"ending_time":1480961940000,"value":1},{"starting_time":1480962180000,"ending_time":1480962240000,"value":1},{"starting_time":1480962480000,"ending_time":1480962540000,"value":1},{"starting_time":1480962780000,"ending_time":1480962840000,"value":1},{"starting_time":1480963080000,"ending_time":1480963140000,"value":1},{"starting_time":1480963380000,"ending_time":1480963440000,"value":1},{"starting_time":1480963680000,"ending_time":1480963740000,"value":1},{"starting_time":1480963980000,"ending_time":1480964040000,"value":1},{"starting_time":1480964280000,"ending_time":1480964340000,"value":1},{"starting_time":1480964580000,"ending_time":1480964640000,"value":1},{"starting_time":1480964880000,"ending_time":1480964940000,"value":1},{"starting_time":1480965180000,"ending_time":1480965240000,"value":1},{"starting_time":1480965480000,"ending_time":1480965540000,"value":1},{"starting_time":1480965780000,"ending_time":1480965840000,"value":1},{"starting_time":1480966080000,"ending_time":1480966140000,"value":1},{"starting_time":1480966380000,"ending_time":1480966440000,"value":1},{"starting_time":1480966680000,"ending_time":1480966740000,"value":1},{"starting_time":1480966980000,"ending_time":1480967040000,"value":1},{"starting_time":1480967280000,"ending_time":1480967340000,"value":1},{"starting_time":1480967580000,"ending_time":1480967640000,"value":1},{"starting_time":1480967880000,"ending_time":1480967940000,"value":1},{"starting_time":1480968180000,"ending_time":1480968240000,"value":1},{"starting_time":1480968480000,"ending_time":1480968540000,"value":1},{"starting_time":1480968780000,"ending_time":1480968840000,"value":1},{"starting_time":1480969140000,"ending_time":1480969200000,"value":1},{"starting_time":1480969440000,"ending_time":1480969500000,"value":1},{"starting_time":1480969740000,"ending_time":1480969800000,"value":1},{"starting_time":1480970040000,"ending_time":1480970100000,"value":1},{"starting_time":1480970340000,"ending_time":1480970400000,"value":1},{"starting_time":1480970640000,"ending_time":1480970700000,"value":1},{"starting_time":1480970940000,"ending_time":1480971000000,"value":1},{"starting_time":1480971240000,"ending_time":1480971300000,"value":1},{"starting_time":1480971540000,"ending_time":1480971600000,"value":1},{"starting_time":1480971840000,"ending_time":1480971900000,"value":1},{"starting_time":1480972140000,"ending_time":1480972200000,"value":1},{"starting_time":1480972440000,"ending_time":1480972500000,"value":1},{"starting_time":1480972740000,"ending_time":1480972800000,"value":1},{"starting_time":1480973040000,"ending_time":1480973100000,"value":1}]},{"label":"20161021_201638_488","class":"warn","times":[{"starting_time":1480903320000,"ending_time":1480903380000,"value":1},{"starting_time":1480903620000,"ending_time":1480903680000,"value":1},{"starting_time":1480903920000,"ending_time":1480903980000,"value":1},{"starting_time":1480904220000,"ending_time":1480904280000,"value":1},{"starting_time":1480904520000,"ending_time":1480904580000,"value":1},{"starting_time":1480905900000,"ending_time":1480905960000,"value":1},{"starting_time":1480906200000,"ending_time":1480906260000,"value":1},{"starting_time":1480906500000,"ending_time":1480906560000,"value":1},{"starting_time":1480906800000,"ending_time":1480906860000,"value":1},{"starting_time":1480907100000,"ending_time":1480907160000,"value":1},{"starting_time":1480907400000,"ending_time":1480907460000,"value":1},{"starting_time":1480907700000,"ending_time":1480907760000,"value":1},{"starting_time":1480908000000,"ending_time":1480908060000,"value":1},{"starting_time":1480908300000,"ending_time":1480908360000,"value":1},{"starting_time":1480908600000,"ending_time":1480908660000,"value":1},{"starting_time":1480908900000,"ending_time":1480908960000,"value":1},{"starting_time":1480909200000,"ending_time":1480909260000,"value":1},{"starting_time":1480909500000,"ending_time":1480909560000,"value":1},{"starting_time":1480909800000,"ending_time":1480909860000,"value":1},{"starting_time":1480910100000,"ending_time":1480910160000,"value":1},{"starting_time":1480910400000,"ending_time":1480910460000,"value":1},{"starting_time":1480910700000,"ending_time":1480910760000,"value":1},{"starting_time":1480911000000,"ending_time":1480911060000,"value":1},{"starting_time":1480911300000,"ending_time":1480911360000,"value":1},{"starting_time":1480911600000,"ending_time":1480911660000,"value":1},{"starting_time":1480911900000,"ending_time":1480911960000,"value":1},{"starting_time":1480912200000,"ending_time":1480912260000,"value":1},{"starting_time":1480912500000,"ending_time":1480912560000,"value":1},{"starting_time":1480912800000,"ending_time":1480912860000,"value":1},{"starting_time":1480913100000,"ending_time":1480913160000,"value":1},{"starting_time":1480913400000,"ending_time":1480913460000,"value":1},{"starting_time":1480913700000,"ending_time":1480913760000,"value":1},{"starting_time":1480914000000,"ending_time":1480914060000,"value":1},{"starting_time":1480914300000,"ending_time":1480914360000,"value":1},{"starting_time":1480914600000,"ending_time":1480914660000,"value":1},{"starting_time":1480914960000,"ending_time":1480915020000,"value":1},{"starting_time":1480915260000,"ending_time":1480915320000,"value":1},{"starting_time":1480915560000,"ending_time":1480915620000,"value":1},{"starting_time":1480915860000,"ending_time":1480915920000,"value":1},{"starting_time":1480916160000,"ending_time":1480916220000,"value":1},{"starting_time":1480916460000,"ending_time":1480916520000,"value":1},{"starting_time":1480916760000,"ending_time":1480916820000,"value":1},{"starting_time":1480917060000,"ending_time":1480917120000,"value":1},{"starting_time":1480917360000,"ending_time":1480917420000,"value":1},{"starting_time":1480917660000,"ending_time":1480917720000,"value":1},{"starting_time":1480917960000,"ending_time":1480918020000,"value":1},{"starting_time":1480918260000,"ending_time":1480918320000,"value":1},{"starting_time":1480918620000,"ending_time":1480918680000,"value":1},{"starting_time":1480918920000,"ending_time":1480918980000,"value":1},{"starting_time":1480919220000,"ending_time":1480919280000,"value":1},{"starting_time":1480919520000,"ending_time":1480919580000,"value":1},{"starting_time":1480919820000,"ending_time":1480919880000,"value":1},{"starting_time":1480920120000,"ending_time":1480920180000,"value":1},{"starting_time":1480920420000,"ending_time":1480920480000,"value":1},{"starting_time":1480920720000,"ending_time":1480920780000,"value":1},{"starting_time":1480921020000,"ending_time":1480921080000,"value":1},{"starting_time":1480921320000,"ending_time":1480921380000,"value":1},{"starting_time":1480921620000,"ending_time":1480921680000,"value":1},{"starting_time":1480921920000,"ending_time":1480921980000,"value":1},{"starting_time":1480922220000,"ending_time":1480922280000,"value":1},{"starting_time":1480922520000,"ending_time":1480922580000,"value":1},{"starting_time":1480922820000,"ending_time":1480922880000,"value":1},{"starting_time":1480923120000,"ending_time":1480923180000,"value":1},{"starting_time":1480923420000,"ending_time":1480923480000,"value":1},{"starting_time":1480923720000,"ending_time":1480923780000,"value":1},{"starting_time":1480924020000,"ending_time":1480924080000,"value":1},{"starting_time":1480924320000,"ending_time":1480924380000,"value":1},{"starting_time":1480924620000,"ending_time":1480924680000,"value":1},{"starting_time":1480924920000,"ending_time":1480924980000,"value":1},{"starting_time":1480925220000,"ending_time":1480925280000,"value":1},{"starting_time":1480925520000,"ending_time":1480925580000,"value":1},{"starting_time":1480925820000,"ending_time":1480925880000,"value":1},{"starting_time":1480926120000,"ending_time":1480926180000,"value":1},{"starting_time":1480926420000,"ending_time":1480926480000,"value":1},{"starting_time":1480926720000,"ending_time":1480926780000,"value":1},{"starting_time":1480927020000,"ending_time":1480927080000,"value":1},{"starting_time":1480927320000,"ending_time":1480927380000,"value":1},{"starting_time":1480927620000,"ending_time":1480927680000,"value":1},{"starting_time":1480927920000,"ending_time":1480927980000,"value":1},{"starting_time":1480928220000,"ending_time":1480928280000,"value":1},{"starting_time":1480928520000,"ending_time":1480928580000,"value":1},{"starting_time":1480928820000,"ending_time":1480928880000,"value":1},{"starting_time":1480929120000,"ending_time":1480929180000,"value":1},{"starting_time":1480929420000,"ending_time":1480929480000,"value":1},{"starting_time":1480929720000,"ending_time":1480929780000,"value":1},{"starting_time":1480930020000,"ending_time":1480930080000,"value":1},{"starting_time":1480930320000,"ending_time":1480930380000,"value":1},{"starting_time":1480930620000,"ending_time":1480930680000,"value":1},{"starting_time":1480930920000,"ending_time":1480930980000,"value":1},{"starting_time":1480931220000,"ending_time":1480931280000,"value":1},{"starting_time":1480931520000,"ending_time":1480931580000,"value":1},{"starting_time":1480931820000,"ending_time":1480931880000,"value":1},{"starting_time":1480932120000,"ending_time":1480932180000,"value":1},{"starting_time":1480932420000,"ending_time":1480932480000,"value":1},{"starting_time":1480932720000,"ending_time":1480932780000,"value":1},{"starting_time":1480933020000,"ending_time":1480933080000,"value":1},{"starting_time":1480933320000,"ending_time":1480933380000,"value":1},{"starting_time":1480933620000,"ending_time":1480933680000,"value":1},{"starting_time":1480933920000,"ending_time":1480933980000,"value":1},{"starting_time":1480934220000,"ending_time":1480934280000,"value":1},{"starting_time":1480934520000,"ending_time":1480934580000,"value":1},{"starting_time":1480934820000,"ending_time":1480934880000,"value":1},{"starting_time":1480935120000,"ending_time":1480935180000,"value":1},{"starting_time":1480935420000,"ending_time":1480935480000,"value":1},{"starting_time":1480935720000,"ending_time":1480935780000,"value":1},{"starting_time":1480936020000,"ending_time":1480936080000,"value":1},{"starting_time":1480936320000,"ending_time":1480936380000,"value":1},{"starting_time":1480936620000,"ending_time":1480936680000,"value":1},{"starting_time":1480936920000,"ending_time":1480936980000,"value":1},{"starting_time":1480937220000,"ending_time":1480937280000,"value":1},{"starting_time":1480937520000,"ending_time":1480937580000,"value":1},{"starting_time":1480937820000,"ending_time":1480937880000,"value":1},{"starting_time":1480938120000,"ending_time":1480938180000,"value":1},{"starting_time":1480938420000,"ending_time":1480938480000,"value":1},{"starting_time":1480938720000,"ending_time":1480938780000,"value":1},{"starting_time":1480939020000,"ending_time":1480939080000,"value":1},{"starting_time":1480939320000,"ending_time":1480939380000,"value":1},{"starting_time":1480939620000,"ending_time":1480939680000,"value":1},{"starting_time":1480939920000,"ending_time":1480939980000,"value":1},{"starting_time":1480940220000,"ending_time":1480940280000,"value":1},{"starting_time":1480940520000,"ending_time":1480940580000,"value":1},{"starting_time":1480940820000,"ending_time":1480940880000,"value":1},{"starting_time":1480941120000,"ending_time":1480941180000,"value":1},{"starting_time":1480941420000,"ending_time":1480941480000,"value":1},{"starting_time":1480941780000,"ending_time":1480941840000,"value":1},{"starting_time":1480942080000,"ending_time":1480942140000,"value":1},{"starting_time":1480942380000,"ending_time":1480942440000,"value":1},{"starting_time":1480942680000,"ending_time":1480942740000,"value":1},{"starting_time":1480942980000,"ending_time":1480943040000,"value":1},{"starting_time":1480943280000,"ending_time":1480943340000,"value":1},{"starting_time":1480943580000,"ending_time":1480943640000,"value":1},{"starting_time":1480943880000,"ending_time":1480943940000,"value":1},{"starting_time":1480944180000,"ending_time":1480944240000,"value":1},{"starting_time":1480944480000,"ending_time":1480944540000,"value":1},{"starting_time":1480944780000,"ending_time":1480944840000,"value":1},{"starting_time":1480945080000,"ending_time":1480945140000,"value":1},{"starting_time":1480945380000,"ending_time":1480945440000,"value":1},{"starting_time":1480945680000,"ending_time":1480945740000,"value":1},{"starting_time":1480945980000,"ending_time":1480946040000,"value":1},{"starting_time":1480946280000,"ending_time":1480946340000,"value":1},{"starting_time":1480946580000,"ending_time":1480946640000,"value":1},{"starting_time":1480946880000,"ending_time":1480946940000,"value":1},{"starting_time":1480947180000,"ending_time":1480947240000,"value":1},{"starting_time":1480947480000,"ending_time":1480947540000,"value":1},{"starting_time":1480947780000,"ending_time":1480947840000,"value":1},{"starting_time":1480948080000,"ending_time":1480948140000,"value":1},{"starting_time":1480948380000,"ending_time":1480948440000,"value":1},{"starting_time":1480948680000,"ending_time":1480948740000,"value":1},{"starting_time":1480948980000,"ending_time":1480949040000,"value":1},{"starting_time":1480949280000,"ending_time":1480949340000,"value":1},{"starting_time":1480949580000,"ending_time":1480949640000,"value":1},{"starting_time":1480949880000,"ending_time":1480949940000,"value":1},{"starting_time":1480950180000,"ending_time":1480950240000,"value":1},{"starting_time":1480950480000,"ending_time":1480950540000,"value":1},{"starting_time":1480950780000,"ending_time":1480950840000,"value":1},{"starting_time":1480951080000,"ending_time":1480951140000,"value":1},{"starting_time":1480951380000,"ending_time":1480951440000,"value":1},{"starting_time":1480951680000,"ending_time":1480951740000,"value":1},{"starting_time":1480951980000,"ending_time":1480952040000,"value":1},{"starting_time":1480952280000,"ending_time":1480952340000,"value":1},{"starting_time":1480952580000,"ending_time":1480952640000,"value":1},{"starting_time":1480952880000,"ending_time":1480952940000,"value":1},{"starting_time":1480953180000,"ending_time":1480953240000,"value":1},{"starting_time":1480953480000,"ending_time":1480953540000,"value":1},{"starting_time":1480953780000,"ending_time":1480953840000,"value":1},{"starting_time":1480954080000,"ending_time":1480954140000,"value":1},{"starting_time":1480954380000,"ending_time":1480954440000,"value":1},{"starting_time":1480954680000,"ending_time":1480954740000,"value":1},{"starting_time":1480954980000,"ending_time":1480955040000,"value":1},{"starting_time":1480955280000,"ending_time":1480955340000,"value":1},{"starting_time":1480955580000,"ending_time":1480955640000,"value":1},{"starting_time":1480955880000,"ending_time":1480955940000,"value":1},{"starting_time":1480956180000,"ending_time":1480956240000,"value":1},{"starting_time":1480956480000,"ending_time":1480956540000,"value":1},{"starting_time":1480956780000,"ending_time":1480956840000,"value":1},{"starting_time":1480957080000,"ending_time":1480957140000,"value":1},{"starting_time":1480957380000,"ending_time":1480957440000,"value":1},{"starting_time":1480957680000,"ending_time":1480957740000,"value":1},{"starting_time":1480957980000,"ending_time":1480958040000,"value":1},{"starting_time":1480958280000,"ending_time":1480958340000,"value":1},{"starting_time":1480958580000,"ending_time":1480958640000,"value":1},{"starting_time":1480958880000,"ending_time":1480958940000,"value":1},{"starting_time":1480959180000,"ending_time":1480959240000,"value":1},{"starting_time":1480959480000,"ending_time":1480959540000,"value":1},{"starting_time":1480959780000,"ending_time":1480959840000,"value":1},{"starting_time":1480960080000,"ending_time":1480960140000,"value":1},{"starting_time":1480960380000,"ending_time":1480960440000,"value":1},{"starting_time":1480960680000,"ending_time":1480960740000,"value":1},{"starting_time":1480960980000,"ending_time":1480961040000,"value":1},{"starting_time":1480961280000,"ending_time":1480961340000,"value":1},{"starting_time":1480961580000,"ending_time":1480961640000,"value":1},{"starting_time":1480961880000,"ending_time":1480961940000,"value":1},{"starting_time":1480962180000,"ending_time":1480962240000,"value":1},{"starting_time":1480962480000,"ending_time":1480962540000,"value":1},{"starting_time":1480962780000,"ending_time":1480962840000,"value":1},{"starting_time":1480963080000,"ending_time":1480963140000,"value":1},{"starting_time":1480963380000,"ending_time":1480963440000,"value":1},{"starting_time":1480963680000,"ending_time":1480963740000,"value":1},{"starting_time":1480963980000,"ending_time":1480964040000,"value":1},{"starting_time":1480964280000,"ending_time":1480964340000,"value":1},{"starting_time":1480964580000,"ending_time":1480964640000,"value":1},{"starting_time":1480964880000,"ending_time":1480964940000,"value":1},{"starting_time":1480965180000,"ending_time":1480965240000,"value":1},{"starting_time":1480965480000,"ending_time":1480965540000,"value":1},{"starting_time":1480965780000,"ending_time":1480965840000,"value":1},{"starting_time":1480966080000,"ending_time":1480966140000,"value":1},{"starting_time":1480966380000,"ending_time":1480966440000,"value":1},{"starting_time":1480966680000,"ending_time":1480966740000,"value":1},{"starting_time":1480966980000,"ending_time":1480967040000,"value":1},{"starting_time":1480967280000,"ending_time":1480967340000,"value":1},{"starting_time":1480967580000,"ending_time":1480967640000,"value":1},{"starting_time":1480967940000,"ending_time":1480968000000,"value":1},{"starting_time":1480968240000,"ending_time":1480968300000,"value":1},{"starting_time":1480968540000,"ending_time":1480968600000,"value":1},{"starting_time":1480968840000,"ending_time":1480968900000,"value":1},{"starting_time":1480969140000,"ending_time":1480969200000,"value":1},{"starting_time":1480969440000,"ending_time":1480969500000,"value":1},{"starting_time":1480969740000,"ending_time":1480969800000,"value":1},{"starting_time":1480970040000,"ending_time":1480970100000,"value":1},{"starting_time":1480970340000,"ending_time":1480970400000,"value":1},{"starting_time":1480970640000,"ending_time":1480970700000,"value":1},{"starting_time":1480970940000,"ending_time":1480971000000,"value":1},{"starting_time":1480971240000,"ending_time":1480971300000,"value":1},{"starting_time":1480971540000,"ending_time":1480971600000,"value":1},{"starting_time":1480971840000,"ending_time":1480971900000,"value":1},{"starting_time":1480972140000,"ending_time":1480972200000,"value":1},{"starting_time":1480972440000,"ending_time":1480972500000,"value":1},{"starting_time":1480972740000,"ending_time":1480972800000,"value":1},{"starting_time":1480973040000,"ending_time":1480973100000,"value":1}]}];



iconTestData.forEach(x => {
  x.maxValue = x.times.reduce((prev, curr) => Math.max(prev, curr.value), 0);
  x.times.forEach(time => time.radio = time.value / x.maxValue);
});

let chartSvg;

const brush = function createDurationBrusher() {
  const data = [{"time":1480903320000,"value":60},{"time":1480903560000,"value":60},{"time":1480903620000,"value":62},{"time":1480903680000,"value":60},{"time":1480903860000,"value":60},{"time":1480903920000,"value":62},{"time":1480903980000,"value":60},{"time":1480904160000,"value":60},{"time":1480904220000,"value":62},{"time":1480904280000,"value":60},{"time":1480904460000,"value":60},{"time":1480904520000,"value":62},{"time":1480904580000,"value":60},{"time":1480904700000,"value":60},{"time":1480904760000,"value":7},{"time":1480904820001,"value":0},{"time":1480905899999,"value":0},{"time":1480905900000,"value":60},{"time":1480906140000,"value":60},{"time":1480906200000,"value":62},{"time":1480906260000,"value":60},{"time":1480906440000,"value":60},{"time":1480906500000,"value":62},{"time":1480906560000,"value":60},{"time":1480906740000,"value":60},{"time":1480906800000,"value":62},{"time":1480906860000,"value":60},{"time":1480907040000,"value":60},{"time":1480907100000,"value":62},{"time":1480907160000,"value":60},{"time":1480907340000,"value":60},{"time":1480907400000,"value":62},{"time":1480907460000,"value":60},{"time":1480907640000,"value":60},{"time":1480907700000,"value":62},{"time":1480907760000,"value":60},{"time":1480907940000,"value":60},{"time":1480908000000,"value":62},{"time":1480908060000,"value":60},{"time":1480908240000,"value":60},{"time":1480908300000,"value":62},{"time":1480908360000,"value":60},{"time":1480908540000,"value":60},{"time":1480908600000,"value":62},{"time":1480908660000,"value":60},{"time":1480908840000,"value":60},{"time":1480908900000,"value":62},{"time":1480908960000,"value":60},{"time":1480909140000,"value":60},{"time":1480909200000,"value":62},{"time":1480909260000,"value":60},{"time":1480909440000,"value":60},{"time":1480909500000,"value":62},{"time":1480909560000,"value":60},{"time":1480909740000,"value":60},{"time":1480909800000,"value":62},{"time":1480909860000,"value":60},{"time":1480910040000,"value":60},{"time":1480910100000,"value":62},{"time":1480910160000,"value":60},{"time":1480910340000,"value":60},{"time":1480910400000,"value":62},{"time":1480910460000,"value":60},{"time":1480910640000,"value":60},{"time":1480910700000,"value":62},{"time":1480910760000,"value":60},{"time":1480910940000,"value":60},{"time":1480911000000,"value":62},{"time":1480911060000,"value":60},{"time":1480911240000,"value":60},{"time":1480911300000,"value":62},{"time":1480911360000,"value":60},{"time":1480911540000,"value":60},{"time":1480911600000,"value":62},{"time":1480911660000,"value":60},{"time":1480911840000,"value":60},{"time":1480911900000,"value":62},{"time":1480911960000,"value":60},{"time":1480912140000,"value":60},{"time":1480912200000,"value":62},{"time":1480912260000,"value":60},{"time":1480912440000,"value":60},{"time":1480912500000,"value":62},{"time":1480912560000,"value":60},{"time":1480912740000,"value":60},{"time":1480912800000,"value":62},{"time":1480912860000,"value":60},{"time":1480913040000,"value":60},{"time":1480913100000,"value":62},{"time":1480913160000,"value":60},{"time":1480913340000,"value":60},{"time":1480913400000,"value":62},{"time":1480913460000,"value":60},{"time":1480913640000,"value":60},{"time":1480913700000,"value":62},{"time":1480913760000,"value":60},{"time":1480913940000,"value":60},{"time":1480914000000,"value":62},{"time":1480914060000,"value":60},{"time":1480914240000,"value":60},{"time":1480914300000,"value":62},{"time":1480914360000,"value":60},{"time":1480914540000,"value":60},{"time":1480914600000,"value":62},{"time":1480914660000,"value":60},{"time":1480914720000,"value":60},{"time":1480914780000,"value":42},{"time":1480914840001,"value":0},{"time":1480914959999,"value":0},{"time":1480914960000,"value":13},{"time":1480915020000,"value":60},{"time":1480915200000,"value":60},{"time":1480915260000,"value":62},{"time":1480915320000,"value":60},{"time":1480915500000,"value":60},{"time":1480915560000,"value":62},{"time":1480915620000,"value":60},{"time":1480915800000,"value":60},{"time":1480915860000,"value":62},{"time":1480915920000,"value":60},{"time":1480916100000,"value":60},{"time":1480916160000,"value":62},{"time":1480916220000,"value":60},{"time":1480916400000,"value":60},{"time":1480916460000,"value":62},{"time":1480916520000,"value":60},{"time":1480916700000,"value":60},{"time":1480916760000,"value":62},{"time":1480916820000,"value":60},{"time":1480917000000,"value":60},{"time":1480917060000,"value":62},{"time":1480917120000,"value":60},{"time":1480917300000,"value":60},{"time":1480917360000,"value":62},{"time":1480917420000,"value":60},{"time":1480917600000,"value":60},{"time":1480917660000,"value":62},{"time":1480917720000,"value":60},{"time":1480917900000,"value":60},{"time":1480917960000,"value":62},{"time":1480918020000,"value":60},{"time":1480918200000,"value":60},{"time":1480918260000,"value":62},{"time":1480918320000,"value":60},{"time":1480918560000,"value":60},{"time":1480918620000,"value":62},{"time":1480918680000,"value":60},{"time":1480918860000,"value":60},{"time":1480918920000,"value":62},{"time":1480918980000,"value":60},{"time":1480919160000,"value":60},{"time":1480919220000,"value":62},{"time":1480919280000,"value":60},{"time":1480919460000,"value":60},{"time":1480919520000,"value":62},{"time":1480919580000,"value":60},{"time":1480919760000,"value":60},{"time":1480919820000,"value":62},{"time":1480919880000,"value":60},{"time":1480920060000,"value":60},{"time":1480920120000,"value":62},{"time":1480920180000,"value":60},{"time":1480920360000,"value":60},{"time":1480920420000,"value":62},{"time":1480920480000,"value":60},{"time":1480920660000,"value":60},{"time":1480920720000,"value":62},{"time":1480920780000,"value":60},{"time":1480920960000,"value":60},{"time":1480921020000,"value":62},{"time":1480921080000,"value":60},{"time":1480921260000,"value":60},{"time":1480921320000,"value":62},{"time":1480921380000,"value":60},{"time":1480921560000,"value":60},{"time":1480921620000,"value":62},{"time":1480921680000,"value":60},{"time":1480921860000,"value":60},{"time":1480921920000,"value":62},{"time":1480921980000,"value":60},{"time":1480922160000,"value":60},{"time":1480922220000,"value":62},{"time":1480922280000,"value":60},{"time":1480922460000,"value":60},{"time":1480922520000,"value":62},{"time":1480922580000,"value":60},{"time":1480922760000,"value":60},{"time":1480922820000,"value":62},{"time":1480922880000,"value":60},{"time":1480923060000,"value":60},{"time":1480923120000,"value":62},{"time":1480923180000,"value":60},{"time":1480923360000,"value":60},{"time":1480923420000,"value":62},{"time":1480923480000,"value":60},{"time":1480923660000,"value":60},{"time":1480923720000,"value":62},{"time":1480923780000,"value":60},{"time":1480923960000,"value":60},{"time":1480924020000,"value":62},{"time":1480924080000,"value":60},{"time":1480924260000,"value":60},{"time":1480924320000,"value":62},{"time":1480924380000,"value":60},{"time":1480924560000,"value":60},{"time":1480924620000,"value":62},{"time":1480924680000,"value":60},{"time":1480924860000,"value":60},{"time":1480924920000,"value":62},{"time":1480924980000,"value":60},{"time":1480925160000,"value":60},{"time":1480925220000,"value":62},{"time":1480925280000,"value":60},{"time":1480925460000,"value":60},{"time":1480925520000,"value":62},{"time":1480925580000,"value":60},{"time":1480925760000,"value":60},{"time":1480925820000,"value":62},{"time":1480925880000,"value":60},{"time":1480926060000,"value":60},{"time":1480926120000,"value":62},{"time":1480926180000,"value":60},{"time":1480926360000,"value":60},{"time":1480926420000,"value":62},{"time":1480926480000,"value":60},{"time":1480926660000,"value":60},{"time":1480926720000,"value":62},{"time":1480926780000,"value":60},{"time":1480926960000,"value":60},{"time":1480927020000,"value":62},{"time":1480927080000,"value":60},{"time":1480927260000,"value":60},{"time":1480927320000,"value":62},{"time":1480927380000,"value":60},{"time":1480927560000,"value":60},{"time":1480927620000,"value":62},{"time":1480927680000,"value":60},{"time":1480927860000,"value":60},{"time":1480927920000,"value":62},{"time":1480927980000,"value":60},{"time":1480928160000,"value":60},{"time":1480928220000,"value":62},{"time":1480928280000,"value":60},{"time":1480928460000,"value":60},{"time":1480928520000,"value":62},{"time":1480928580000,"value":60},{"time":1480928760000,"value":60},{"time":1480928820000,"value":62},{"time":1480928880000,"value":60},{"time":1480929060000,"value":60},{"time":1480929120000,"value":62},{"time":1480929180000,"value":60},{"time":1480929360000,"value":60},{"time":1480929420000,"value":62},{"time":1480929480000,"value":60},{"time":1480929660000,"value":60},{"time":1480929720000,"value":62},{"time":1480929780000,"value":60},{"time":1480929960000,"value":60},{"time":1480930020000,"value":62},{"time":1480930080000,"value":60},{"time":1480930260000,"value":60},{"time":1480930320000,"value":62},{"time":1480930380000,"value":60},{"time":1480930560000,"value":60},{"time":1480930620000,"value":62},{"time":1480930680000,"value":60},{"time":1480930860000,"value":60},{"time":1480930920000,"value":62},{"time":1480930980000,"value":60},{"time":1480931160000,"value":60},{"time":1480931220000,"value":62},{"time":1480931280000,"value":60},{"time":1480931460000,"value":60},{"time":1480931520000,"value":62},{"time":1480931580000,"value":60},{"time":1480931760000,"value":60},{"time":1480931820000,"value":62},{"time":1480931880000,"value":60},{"time":1480932060000,"value":60},{"time":1480932120000,"value":62},{"time":1480932180000,"value":60},{"time":1480932360000,"value":60},{"time":1480932420000,"value":62},{"time":1480932480000,"value":60},{"time":1480932660000,"value":60},{"time":1480932720000,"value":62},{"time":1480932780000,"value":60},{"time":1480932960000,"value":60},{"time":1480933020000,"value":62},{"time":1480933080000,"value":60},{"time":1480933260000,"value":60},{"time":1480933320000,"value":62},{"time":1480933380000,"value":60},{"time":1480933560000,"value":60},{"time":1480933620000,"value":62},{"time":1480933680000,"value":60},{"time":1480933860000,"value":60},{"time":1480933920000,"value":62},{"time":1480933980000,"value":60},{"time":1480934160000,"value":60},{"time":1480934220000,"value":62},{"time":1480934280000,"value":60},{"time":1480934460000,"value":60},{"time":1480934520000,"value":62},{"time":1480934580000,"value":60},{"time":1480934760000,"value":60},{"time":1480934820000,"value":62},{"time":1480934880000,"value":60},{"time":1480935060000,"value":60},{"time":1480935120000,"value":62},{"time":1480935180000,"value":60},{"time":1480935360000,"value":60},{"time":1480935420000,"value":62},{"time":1480935480000,"value":60},{"time":1480935660000,"value":60},{"time":1480935720000,"value":62},{"time":1480935780000,"value":60},{"time":1480935960000,"value":60},{"time":1480936020000,"value":62},{"time":1480936080000,"value":60},{"time":1480936260000,"value":60},{"time":1480936320000,"value":62},{"time":1480936380000,"value":60},{"time":1480936560000,"value":60},{"time":1480936620000,"value":62},{"time":1480936680000,"value":60},{"time":1480936860000,"value":60},{"time":1480936920000,"value":62},{"time":1480936980000,"value":60},{"time":1480937160000,"value":60},{"time":1480937220000,"value":62},{"time":1480937280000,"value":60},{"time":1480937460000,"value":60},{"time":1480937520000,"value":62},{"time":1480937580000,"value":60},{"time":1480937760000,"value":60},{"time":1480937820000,"value":62},{"time":1480937880000,"value":60},{"time":1480938060000,"value":60},{"time":1480938120000,"value":62},{"time":1480938180000,"value":60},{"time":1480938360000,"value":60},{"time":1480938420000,"value":62},{"time":1480938480000,"value":60},{"time":1480938660000,"value":60},{"time":1480938720000,"value":62},{"time":1480938780000,"value":60},{"time":1480938960000,"value":60},{"time":1480939020000,"value":62},{"time":1480939080000,"value":60},{"time":1480939260000,"value":60},{"time":1480939320000,"value":62},{"time":1480939380000,"value":60},{"time":1480939560000,"value":60},{"time":1480939620000,"value":62},{"time":1480939680000,"value":60},{"time":1480939860000,"value":60},{"time":1480939920000,"value":62},{"time":1480939980000,"value":60},{"time":1480940160000,"value":60},{"time":1480940220000,"value":62},{"time":1480940280000,"value":60},{"time":1480940460000,"value":60},{"time":1480940520000,"value":62},{"time":1480940580000,"value":60},{"time":1480940760000,"value":60},{"time":1480940820000,"value":62},{"time":1480940880000,"value":60},{"time":1480941060000,"value":60},{"time":1480941120000,"value":62},{"time":1480941180000,"value":60},{"time":1480941360000,"value":60},{"time":1480941420000,"value":62},{"time":1480941480000,"value":60},{"time":1480941660000,"value":60},{"time":1480941720000,"value":61},{"time":1480941780000,"value":61},{"time":1480941840000,"value":60},{"time":1480941960000,"value":60},{"time":1480942020000,"value":61},{"time":1480942080000,"value":61},{"time":1480942140000,"value":60},{"time":1480942260000,"value":60},{"time":1480942320000,"value":61},{"time":1480942380000,"value":61},{"time":1480942440000,"value":60},{"time":1480942560000,"value":60},{"time":1480942620000,"value":61},{"time":1480942680000,"value":61},{"time":1480942740000,"value":60},{"time":1480942860000,"value":60},{"time":1480942920000,"value":61},{"time":1480942980000,"value":61},{"time":1480943040000,"value":60},{"time":1480943160000,"value":60},{"time":1480943220000,"value":61},{"time":1480943280000,"value":61},{"time":1480943340000,"value":60},{"time":1480943460000,"value":60},{"time":1480943520000,"value":61},{"time":1480943580000,"value":61},{"time":1480943640000,"value":60},{"time":1480943760000,"value":60},{"time":1480943820000,"value":61},{"time":1480943880000,"value":61},{"time":1480943940000,"value":60},{"time":1480944060000,"value":60},{"time":1480944120000,"value":61},{"time":1480944180000,"value":61},{"time":1480944240000,"value":60},{"time":1480944360000,"value":60},{"time":1480944420000,"value":61},{"time":1480944480000,"value":61},{"time":1480944540000,"value":60},{"time":1480944660000,"value":60},{"time":1480944720000,"value":61},{"time":1480944780000,"value":61},{"time":1480944840000,"value":60},{"time":1480944960000,"value":60},{"time":1480945020000,"value":61},{"time":1480945080000,"value":61},{"time":1480945140000,"value":60},{"time":1480945260000,"value":60},{"time":1480945320000,"value":61},{"time":1480945380000,"value":61},{"time":1480945440000,"value":60},{"time":1480945560000,"value":60},{"time":1480945620000,"value":61},{"time":1480945680000,"value":61},{"time":1480945740000,"value":60},{"time":1480945860000,"value":60},{"time":1480945920000,"value":61},{"time":1480945980000,"value":61},{"time":1480946040000,"value":60},{"time":1480946160000,"value":60},{"time":1480946220000,"value":61},{"time":1480946280000,"value":61},{"time":1480946340000,"value":60},{"time":1480946460000,"value":60},{"time":1480946520000,"value":61},{"time":1480946580000,"value":61},{"time":1480946640000,"value":60},{"time":1480946820000,"value":60},{"time":1480946880000,"value":62},{"time":1480946940000,"value":60},{"time":1480947120000,"value":60},{"time":1480947180000,"value":62},{"time":1480947240000,"value":60},{"time":1480947420000,"value":60},{"time":1480947480000,"value":62},{"time":1480947540000,"value":60},{"time":1480947720000,"value":60},{"time":1480947780000,"value":62},{"time":1480947840000,"value":60},{"time":1480948020000,"value":60},{"time":1480948080000,"value":62},{"time":1480948140000,"value":60},{"time":1480948320000,"value":60},{"time":1480948380000,"value":62},{"time":1480948440000,"value":60},{"time":1480948620000,"value":60},{"time":1480948680000,"value":62},{"time":1480948740000,"value":60},{"time":1480948920000,"value":60},{"time":1480948980000,"value":62},{"time":1480949040000,"value":60},{"time":1480949220000,"value":60},{"time":1480949280000,"value":62},{"time":1480949340000,"value":60},{"time":1480949520000,"value":60},{"time":1480949580000,"value":62},{"time":1480949640000,"value":60},{"time":1480949820000,"value":60},{"time":1480949880000,"value":62},{"time":1480949940000,"value":60},{"time":1480950120000,"value":60},{"time":1480950180000,"value":62},{"time":1480950240000,"value":60},{"time":1480950420000,"value":60},{"time":1480950480000,"value":62},{"time":1480950540000,"value":60},{"time":1480950720000,"value":60},{"time":1480950780000,"value":62},{"time":1480950840000,"value":60},{"time":1480951020000,"value":60},{"time":1480951080000,"value":62},{"time":1480951140000,"value":60},{"time":1480951320000,"value":60},{"time":1480951380000,"value":62},{"time":1480951440000,"value":60},{"time":1480951620000,"value":60},{"time":1480951680000,"value":62},{"time":1480951740000,"value":60},{"time":1480951920000,"value":60},{"time":1480951980000,"value":62},{"time":1480952040000,"value":60},{"time":1480952220000,"value":60},{"time":1480952280000,"value":62},{"time":1480952340000,"value":60},{"time":1480952520000,"value":60},{"time":1480952580000,"value":62},{"time":1480952640000,"value":60},{"time":1480952820000,"value":60},{"time":1480952880000,"value":62},{"time":1480952940000,"value":60},{"time":1480953120000,"value":60},{"time":1480953180000,"value":62},{"time":1480953240000,"value":60},{"time":1480953420000,"value":60},{"time":1480953480000,"value":62},{"time":1480953540000,"value":60},{"time":1480953720000,"value":60},{"time":1480953780000,"value":62},{"time":1480953840000,"value":60},{"time":1480954020000,"value":60},{"time":1480954080000,"value":62},{"time":1480954140000,"value":60},{"time":1480954320000,"value":60},{"time":1480954380000,"value":62},{"time":1480954440000,"value":60},{"time":1480954620000,"value":60},{"time":1480954680000,"value":62},{"time":1480954740000,"value":60},{"time":1480954920000,"value":60},{"time":1480954980000,"value":62},{"time":1480955040000,"value":60},{"time":1480955220000,"value":60},{"time":1480955280000,"value":62},{"time":1480955340000,"value":60},{"time":1480955520000,"value":60},{"time":1480955580000,"value":62},{"time":1480955640000,"value":60},{"time":1480955820000,"value":60},{"time":1480955880000,"value":62},{"time":1480955940000,"value":60},{"time":1480956120000,"value":60},{"time":1480956180000,"value":62},{"time":1480956240000,"value":60},{"time":1480956420000,"value":60},{"time":1480956480000,"value":62},{"time":1480956540000,"value":60},{"time":1480956720000,"value":60},{"time":1480956780000,"value":62},{"time":1480956840000,"value":60},{"time":1480957020000,"value":60},{"time":1480957080000,"value":62},{"time":1480957140000,"value":60},{"time":1480957320000,"value":60},{"time":1480957380000,"value":62},{"time":1480957440000,"value":60},{"time":1480957620000,"value":60},{"time":1480957680000,"value":62},{"time":1480957740000,"value":60},{"time":1480957920000,"value":60},{"time":1480957980000,"value":62},{"time":1480958040000,"value":60},{"time":1480958220000,"value":60},{"time":1480958280000,"value":62},{"time":1480958340000,"value":60},{"time":1480958520000,"value":60},{"time":1480958580000,"value":62},{"time":1480958640000,"value":60},{"time":1480958820000,"value":60},{"time":1480958880000,"value":62},{"time":1480958940000,"value":60},{"time":1480959120000,"value":60},{"time":1480959180000,"value":62},{"time":1480959240000,"value":60},{"time":1480959420000,"value":60},{"time":1480959480000,"value":62},{"time":1480959540000,"value":60},{"time":1480959720000,"value":60},{"time":1480959780000,"value":62},{"time":1480959840000,"value":60},{"time":1480960020000,"value":60},{"time":1480960080000,"value":62},{"time":1480960140000,"value":60},{"time":1480960320000,"value":60},{"time":1480960380000,"value":62},{"time":1480960440000,"value":60},{"time":1480960620000,"value":60},{"time":1480960680000,"value":62},{"time":1480960740000,"value":60},{"time":1480960920000,"value":60},{"time":1480960980000,"value":62},{"time":1480961040000,"value":60},{"time":1480961220000,"value":60},{"time":1480961280000,"value":62},{"time":1480961340000,"value":60},{"time":1480961520000,"value":60},{"time":1480961580000,"value":62},{"time":1480961640000,"value":60},{"time":1480961820000,"value":60},{"time":1480961880000,"value":62},{"time":1480961940000,"value":60},{"time":1480962120000,"value":60},{"time":1480962180000,"value":62},{"time":1480962240000,"value":60},{"time":1480962420000,"value":60},{"time":1480962480000,"value":62},{"time":1480962540000,"value":60},{"time":1480962720000,"value":60},{"time":1480962780000,"value":62},{"time":1480962840000,"value":60},{"time":1480963020000,"value":60},{"time":1480963080000,"value":62},{"time":1480963140000,"value":60},{"time":1480963320000,"value":60},{"time":1480963380000,"value":62},{"time":1480963440000,"value":60},{"time":1480963620000,"value":60},{"time":1480963680000,"value":62},{"time":1480963740000,"value":60},{"time":1480963920000,"value":60},{"time":1480963980000,"value":62},{"time":1480964040000,"value":60},{"time":1480964220000,"value":60},{"time":1480964280000,"value":62},{"time":1480964340000,"value":60},{"time":1480964520000,"value":60},{"time":1480964580000,"value":62},{"time":1480964640000,"value":60},{"time":1480964820000,"value":60},{"time":1480964880000,"value":62},{"time":1480964940000,"value":60},{"time":1480965120000,"value":60},{"time":1480965180000,"value":62},{"time":1480965240000,"value":60},{"time":1480965420000,"value":60},{"time":1480965480000,"value":62},{"time":1480965540000,"value":60},{"time":1480965720000,"value":60},{"time":1480965780000,"value":62},{"time":1480965840000,"value":60},{"time":1480966020000,"value":60},{"time":1480966080000,"value":62},{"time":1480966140000,"value":60},{"time":1480966320000,"value":60},{"time":1480966380000,"value":62},{"time":1480966440000,"value":60},{"time":1480966620000,"value":60},{"time":1480966680000,"value":62},{"time":1480966740000,"value":60},{"time":1480966920000,"value":60},{"time":1480966980000,"value":62},{"time":1480967040000,"value":60},{"time":1480967220000,"value":60},{"time":1480967280000,"value":62},{"time":1480967340000,"value":60},{"time":1480967520000,"value":60},{"time":1480967580000,"value":62},{"time":1480967640000,"value":60},{"time":1480967820000,"value":60},{"time":1480967880000,"value":61},{"time":1480967940000,"value":61},{"time":1480968000000,"value":60},{"time":1480968120000,"value":60},{"time":1480968180000,"value":61},{"time":1480968240000,"value":61},{"time":1480968300000,"value":60},{"time":1480968420000,"value":60},{"time":1480968480000,"value":61},{"time":1480968540000,"value":61},{"time":1480968600000,"value":60},{"time":1480968720000,"value":60},{"time":1480968780000,"value":61},{"time":1480968840000,"value":61},{"time":1480968900000,"value":60},{"time":1480969080000,"value":60},{"time":1480969140000,"value":62},{"time":1480969200000,"value":60},{"time":1480969380000,"value":60},{"time":1480969440000,"value":62},{"time":1480969500000,"value":60},{"time":1480969680000,"value":60},{"time":1480969740000,"value":62},{"time":1480969800000,"value":60},{"time":1480969980000,"value":60},{"time":1480970040000,"value":62},{"time":1480970100000,"value":60},{"time":1480970280000,"value":60},{"time":1480970340000,"value":62},{"time":1480970400000,"value":60},{"time":1480970580000,"value":60},{"time":1480970640000,"value":62},{"time":1480970700000,"value":60},{"time":1480970880000,"value":60},{"time":1480970940000,"value":62},{"time":1480971000000,"value":60},{"time":1480971180000,"value":60},{"time":1480971240000,"value":62},{"time":1480971300000,"value":60},{"time":1480971480000,"value":60},{"time":1480971540000,"value":62},{"time":1480971600000,"value":60},{"time":1480971780000,"value":60},{"time":1480971840000,"value":62},{"time":1480971900000,"value":60},{"time":1480972080000,"value":60},{"time":1480972140000,"value":62},{"time":1480972200000,"value":60},{"time":1480972380000,"value":60},{"time":1480972440000,"value":62},{"time":1480972500000,"value":60},{"time":1480972680000,"value":60},{"time":1480972740000,"value":62},{"time":1480972800000,"value":60},{"time":1480972980000,"value":60},{"time":1480973040000,"value":62}];
  const svg = d3.select('#durationBrusher').append('svg')
    .attr('width', 970)
    .attr('height', 46);

  const x = d3.time.scale()
    .range([0, 970])
    .domain(d3.extent(data, d => d.time));

  const y = d3.scale.linear()
    .range([46, 0])
    .domain([0, d3.max(data, d => d.value) * 1.2]);

  const bgArea = d3.svg.area()
    .x(d => x(+d.time))
    .y0(46)
    .y1(d => y(+d.value));

  svg.append('path')
    .attr('fill', '#f0f0f0')
    .datum(data)
    .attr('d', bgArea);

  const brush = d3.svg.brush().x(x);

  const b = svg.append('g')
    .attr('class', 'x brush')
    .call(brush);

  b.selectAll('rect')
    .attr('height', 46);

  b.selectAll('.resize rect')
    .attr('style', null)
    .attr('width', 12)
    .attr('x', -6);

  b.selectAll('.resize')
    .append('line')
    .attr('x1', -2)
    .attr('y1', 21)
    .attr('x2', 6)
    .attr('y2', 21);
  b.selectAll('.resize')
    .append('line')
    .attr('x1', -2)
    .attr('y1', 23)
    .attr('x2', 6)
    .attr('y2', 23);
  b.select('.resize.w')
    .append('text')
    .attr('y', 23)
    .selectAll('tspan')
    .data(['date', 'time'])
    .enter()
    .append('tspan')
    .attr('class', d => d)
    .attr('x', 0)
    .attr('dy', (d, i) => i ? '1.2em' : 0);
  b.select('.resize.e')
    .append('text')
    .attr('y', 23)
    .selectAll('tspan')
    .data(['date', 'time'])
    .enter()
    .append('tspan')
    .attr('class', d => d)
    .attr('x', 0)
    .attr('dy', (d, i) => i ? '1.2em' : 0);

  b.selectAll('.resize.w line')
    .attr('transform', 'translate(-4 0)');

  return brush;
}();


const formatDate = d3.time.format('%Y.%m.%d');
const formatTime = d3.time.format('%I:%M %p');
const brushText = function (bParent) {
  const [beginning, ending] = brush.extent().map(x => new Date(x));
  bParent.selectAll('.resize.w tspan')
    .data([formatDate(beginning), formatTime(beginning)])
    .attr('x', 0)
    .text(d => d);
  bParent.selectAll('.resize.e tspan')
    .data([formatDate(ending), formatTime(ending)])
    .attr('x', 0)
    .text(d => d);

  const scale = brush.x();
  bParent.classed('text-hidden', scale(ending) - scale(beginning) < 170);
};

const chart = function createTimeline() {
  let mouseoverItem;

  const colorScale = d3.scale.linear()
    .domain([0, .5, 1])
    .interpolate(d3.interpolateHcl)
    .range([d3.rgb('#55BF3B'), d3.rgb('#DDDF0D'), d3.rgb('#DF5353')]);

  const chart = d3.timeline()
    .zoomable()
    .showTimeAxisTick()
    .margin({left:70, right:30, top:5, bottom:0})
    .background('#eee')
    .rowSeparators('black')
    .colors(colorScale)
    .colorProperty('radio')
    .customiseLine((g, datum) => {
      console.log(g, datum);
    })
    .mouseover((d, i, datum) => {
      mouseoverItem = d;
    })
    .mouseout((d, i, datum) => {
      mouseoverItem = undefined;
    });

  const format = d3.time.format("%X")

  const svg = chartSvg = d3.select('#timeline').append('svg').attr('width', 1000)
    .datum(iconTestData).call(chart);

  var xrScale = d3.time.scale()
    .domain([0, 900])
    .range([chart.beginning(), chart.ending()]);

  const block = svg.select('.timeline-series-block')
    .on('mousemove', function() {
      const [x, y] = d3.mouse(this);

      xrScale.range([chart.beginning(), chart.ending()]);

      let text = format(new Date(xrScale(x)));

      if (mouseoverItem) {
        text += ' Number: ' + mouseoverItem.value;
      }

      const textElement = line.attr('transform', `translate(${x} 0)`)
        .select('.label').attr('transform', `translate(5 ${y - 9})`)
        .select('.label text').text(text);
      line.select('.label rect').attr('width', textElement.node().getBBox().width + 10);
    })
    .on('mouseout', function() {
      line.classed('hidden', true)
    })
    .on('mouseover', function() {
      line.classed('hidden', false)
    });

  const { left , right } = chart.margin()
  svg.append('line')
    .attr('class', 'top-line')
    .attr('x1', left)
    .attr('x2', chart.width() - right)
    .attr('y1', 2)
    .attr('y2', 2);

  var line = svg.append('g')
    .attr('transform', 'translate(70 5)')
    .append('g')
    .attr('class', 'line hidden')
    .call(g => {
      g.append('line')
        .attr('x1', 0)
        .attr('x2', 0)
        .attr('y1', -2)
        .attr('y2', chart.height() - 25 - 6 + chart.itemMargin());
      const textg = g.append('g')
        .attr('class', 'label');
      textg.append('rect')
        .attr('height', '2em')
        .attr('rx', 5)
        .attr('ry', 5)
        .attr('x', 10);
      textg.append('text')
        .attr('x', 15)
        .attr('y', '1.05em')
        .style('dominant-baseline', 'middle')
        .style('text-anchor', 'start')
        .text('? PM');
    });

  return chart;
}();

chart.zoom((beginning, ending) => {
  tmin.value = new Date(beginning).toDateInputValue();
  tmax.value = new Date(ending).toDateInputValue();
  brush.extent([beginning, ending])
  d3.select('#durationBrusher .x.brush').call(brush).call(brushText);
})

d3.selectAll('input[type=datetime-local]').on('change', function () {
  chart.extent([tmin.valueAsNumber, tmax.valueAsNumber], chartSvg);
  brush.extent([tmin.valueAsNumber, tmax.valueAsNumber])
});

brush.on('brush', function () {
  const [start, end] = brush.extent();
  tmin.value = new Date(start).toDateInputValue();
  tmax.value = new Date(end).toDateInputValue();
  console.log(tmin.value, tmax.value);
  chart.extent([start, end], chartSvg);
  d3.select('#durationBrusher .x.brush').call(brushText);
});
